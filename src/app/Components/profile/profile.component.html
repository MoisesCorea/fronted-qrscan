<app-alert></app-alert>

<mat-tab-group class="container-fluid mt-4" animationDuration="0ms">
  <mat-tab>
    <ng-template mat-tab-label>
      <mat-icon class="tab-icon">account_circle</mat-icon>
      Perfil
    </ng-template>

    <div class="container-main">
      <div class="row justify-content-center mt-5">
        <div class="col">
          <form
            class="form mx-5 mt-5 mb-5"
            [formGroup]="profileForm"
            (ngSubmit)="updateUser()"
          >
            <div class="row mt-sm-3">
              <div class="col-md mb-3">
                <label class="form-label" for="name">Nombre: </label>
                <input class="form-control" type="text" [formControl]="name" />
                <div
                  *ngIf="name.errors && isValidForm != null && !isValidForm"
                  [ngClass]="'error'"
                >
                  <div *ngIf="name.errors.required">El nombre es requerido</div>
                  <div *ngIf="name.errors.minlength">
                    El nombre debe tener al menos 5 carcateres
                  </div>
                  <div *ngIf="name.errors.maxlength">
                    El nombre debe tener un longitud maxima de 255 caracteres
                  </div>
                </div>
              </div>
              <div class="col-md mb-3">
                <label class="form-label" for="last_name">Apellido: </label>
                <input
                  class="form-control"
                  type="text"
                  [formControl]="last_name"
                />
                <div
                  *ngIf="
                    last_name.errors && isValidForm != null && !isValidForm
                  "
                  [ngClass]="'error'"
                >
                  <div *ngIf="last_name.errors.required">
                    El apellido es requerido
                  </div>
                  <div *ngIf="last_name.errors.minlength">
                    El epellido debe tener al menos 5 carcateres
                  </div>
                  <div *ngIf="last_name.errors.maxlength">
                    El apellido debe tener un longitud maxima de 255 caracteres
                  </div>
                </div>
              </div>
            </div>
            <div class="row mt-sm-4">
              <div class="col-md mb-3">
                <label class="form-label" for="email">Email: </label>
                <input
                  class="form-control"
                  type="email"
                  [formControl]="email"
                />
                <div
                  *ngIf="email.errors && isValidForm != null && !isValidForm"
                  [ngClass]="'error'"
                >
                  <div *ngIf="email.errors.required">
                    El correo electrónico is requerido
                  </div>
                  <div *ngIf="email.errors.pattern">
                    El correo no tiene un formato valido.
                  </div>
                </div>
              </div>

              <div class="col-md mb-3">
                <label class="form-label" for="alias">Alias: </label>
                <input class="form-control" type="text" [formControl]="alias" />
                <div
                  *ngIf="alias.errors && isValidForm != null && !isValidForm"
                  [ngClass]="'error'"
                >
                  <div *ngIf="alias.errors.required">El alias es requiredo</div>
                  <div *ngIf="alias.errors.minlength">
                    Alias debe tener al menos 5 carcateres.
                  </div>
                  <div *ngIf="alias.errors.maxlength">
                    Alias debe tener un longitud maxima de 255 caracteres.
                  </div>
                </div>
              </div>
            </div>

            <button
              class="btn btn-secondary mt-4"
              *ngIf="isFormDisabled()"
              (click)="toggleDisabled()"
            >
              Editar
            </button>
            <button
              class="btn btn-primary mt-4"
              *ngIf="!isFormDisabled()"
              type="submit"
            >
              Actualizar
            </button>
          </form>
        </div>
      </div>
    </div>
  </mat-tab>
  <mat-tab>
    <ng-template mat-tab-label>
      <mat-icon class="tab-icon">lock</mat-icon>
      Contraseña
    </ng-template>
    <div class="container-main">
      <div class="row justify-content-center mt-5">
        <div class="col-md-10">
          <form
            class="form mx-5 mt-5 mb-5"
            [formGroup]="passwordForm"
            (ngSubmit)="onSubmitPassword()"
          >
            <div class="form-group mb-4">
              <label class="form-label" for="current_password"
                >Contraseña Actual</label
              >
              <input
                type="password"
                class="form-control"
                id="current_password"
                [formControl]="current_password"
              />
              <div
                *ngIf="
                  current_password.errors && isValidForm != null && !isValidForm
                "
                [ngClass]="'error'"
              >
                <div *ngIf="current_password.errors.required">
                  La contraseña actual es requirida.
                </div>
              </div>
            </div>
            <div class="form-group mb-4">
              <label class="form-label" for="new_password"
                >Nueva Contraseña</label
              >
              <input
                type="password"
                class="form-control"
                id="new_password"
                [formControl]="new_password"
              />
              <div
                *ngIf="
                  new_password.errors && isValidForm != null && !isValidForm
                "
                [ngClass]="'error'"
              >
                <div *ngIf="new_password.errors.required">
                  La nueva contraseña es requirida
                </div>
                <div *ngIf="new_password.errors.minlength">
                  La contraseña debe tener al menos 8 carcateres.
                </div>
              </div>
            </div>
            <div class="form-group mb-5">
              <label class="form-label" for="confirm_password"
                >Confirmar Nueva Contraseña</label
              >
              <input
                type="password"
                class="form-control"
                id="confirm_password"
                [formControl]="confirm_password"
              />

              <div
                *ngIf="
                  confirm_password.errors && isValidForm != null && !isValidForm
                "
                [ngClass]="'error'"
              >
                <div *ngIf="confirm_password.errors.required">
                  La confirmación de la nueva contraseña es requireda.
                </div>
              </div>
            </div>
            <button type="submit" class="btn btn-primary">Actualizar</button>
          </form>
        </div>
      </div>
    </div>
  </mat-tab>
</mat-tab-group>
